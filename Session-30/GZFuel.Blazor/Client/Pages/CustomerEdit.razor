@page "/customerlist/customeredit/{Id:int?}"
@using GZFuel.Blazor.Shared.DTO.Customer;
@inject HttpClient httpClient;
@inject NavigationManager NavigationManager;


<h3>Customer Editt</h3>

@if (customer == null)
{
	<p>Loading ... </p>
}


<div class="row" >

	  <div class="col-md-6">
         
		  <label class="form-label"> Name </label>
		  <input class="form-control" @bing="@customer.Name"/>

	  
	  </div>

	<div class="col-md-6">

		<label class="form-label"> Surname </label>
		<input class="form-control" @bing="@customer.Surname" />


	</div>

	<div class="col-md-6">

		<label class="form-label"> CardNumber </label>
		<input class="form-control" @bing="@customer.CardNumber" placeholder="it will be autogenerated" />


	</div>

	
</div>

<div class="row">

<div class="col-md-12">

		<button class="btn btn-primary" @onclick="SaveItem">Save</button>

	</div>

	<div class="col-md-12">

		<button class="btn btn-danger" @onclick="OnCancel">Cancel</button>

	</div>
</div>









@code {
	[Parameter] public int? Id { get; set; }
	CustomerDTO customer{ get; set; }




	protected override async Task OnInitializedAsync()
	{
		if (Id==null)
		{
			customer = new();
		} else
		{
			
			customer = await httpClient.GetFromJsonAsync<CustomerDTO>($"customer/{Id}");

		}
	}


	private void OnCancel()
	{
		NavigationManager.NavigateTo("/customerlist");
	}

	private async Task SaveItem()
	{
		if (Id==null)
		{
			var response = await httpClient.PostAsJsonAsync("Customer", customer);
			response.EnsureSuccessStatusCode();
			NavigationManager.NavigateTo("/customerlist");
			
			
		}
		else
		{
			await httpClient.PostAsJsonAsync($"Customer/{Id}", customer);
		}
		
	}






}
